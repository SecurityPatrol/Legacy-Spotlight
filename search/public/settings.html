<!DOCTYPE html>
<html lang="ja">

    <head>

        <meta charset="utf-8">
        <title>Search Setting</title>

        <link rel="stylesheet" href="/yacona/base">
        <link rel="stylesheet" href="resources/css/common.css">
        <style>

            .server {
                line-height: 22pt;
            }

        </style>

    </head>

    <body>

        <section id="application">

            <nav>
               
                <div class="menu white">Spotlight v0.5.4</div>
                <a href="index.html">
                    <div class="menu">
                        <div class="left">検索</div>
                        <div class="right"></div>
                    </div>
                </a>
                <a href="advanced.html">
                    <div class="menu">
                        <div class="left">高度な検索</div>
                        <div class="right"></div>
                    </div>
                </a>
                <div class="menu selected">
                    <div class="left">設定</div>
                    <div class="right"></div>
                </div>

            </nav>
            
            <div id="myProfile">
                <div id="load">
                    <img src="" id="icon">
                    <div id="name"></div>
                    <div id="screen_name">@</div>
                </div>
            </div>

            <div id="main">

                <div class="title" style="margin-top: 0">検索件数</div>
                <div class="content clearfix">
                    <textarea id="search_count" placeholder="件数（最大 100 件）"></textarea>
                    <div class="btn float_r" onclick="save( 'search_count' )">保存</div>
                </div>

            </div>
            
            <div id="loading" style="display: none"></div>

        </section>

    </body>

    <script src="/socket.io/socket.io.js"></script>
    <script src="/yacona/preload"></script>
    <script src="/yacona/common"></script>
    <script>

        socket.on( 'saved', function(){
            document.getElementById( 'loading' ).style.display = 'none'
        } )
        
        socket.emit( 'getConfig', true )
        socket.on( 'config', function( value ){
            if( value.search_count ) document.getElementById( 'search_count' ).placeholder = value.search_count
        } )
        
        function save( type ){
            let count = document.getElementById( 'search_count' ).value
            if( count === '' ) return false
            if( type === 'search_count' && count.match( /\d+/ ) && count.match( /\d+/ ).input === count ){
                document.getElementById( 'loading' ).style.display = 'block'
                socket.emit( 'config', { search_count: Number( count ) } )
            } else alert( '使用できない文字が含まれています' )
        }

    </script>

</html>